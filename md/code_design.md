# 接口模式

## (一)、restfull 

### 1、核心

restful简单点讲就做了三件事：

1. 约定 url可读。      url对应资源    GET:product/2   获取id=2的商品的想起
2. 约定 操作可读。                           增post、删delete、改put、查get
3. 约定 状态码可读。                       code=404标识资源不存在



>  REST，即Representational State Transfer的缩写。我对这个词组的翻译是"表现层状态转化"。
>
> 完整的讲是“资源变现层状态转化”
>
>  
>
> **一、资源（Resources）**
>
> REST的名称"表现层状态转化"中，省略了主语。"表现层"其实指的是"资源"（Resources）的"表现层"。
>
> **所谓"资源"，就是网络上的一个实体，或者说是网络上的一个具体信息。**它可以是一段文本、一张图片、一首歌曲、一种服务，总之就是一个具体的实在。你可以用一个URI（统一资源定位符）指向它，每种资源对应一个特定的URI。要获取这个资源，访问它的URI就可以，因此URI就成了每一个资源的地址或独一无二的识别符。
>
> 所谓"上网"，就是与互联网上一系列的"资源"互动，调用它的URI。
>
> 
>
> **二、表现层（Representation）**
>
> "资源"是一种信息实体，它可以有多种外在表现形式。**我们把"资源"具体呈现出来的形式，叫做它的"表现层"（Representation）。**
>
> 比如，文本可以用txt格式表现，也可以用HTML格式、XML格式、JSON格式表现，甚至可以采用二进制格式；图片可以用JPG格式表现，也可以用PNG格式表现。
>
> URI只代表资源的实体，不代表它的形式。严格地说，有些网址最后的".html"后缀名是不必要的，因为这个后缀名表示格式，属于"表现层"范畴，而URI应该只代表"资源"的位置。它的具体表现形式，应该在HTTP请求的头信息中用Accept和Content-Type字段指定，这两个字段才是对"表现层"的描述。
>
> 
>
> **三、状态转化（State Transfer）**
>
> 访问一个网站，就代表了客户端和服务器的一个互动过程。在这个过程中，势必涉及到数据和状态的变化。
>
> 互联网通信协议HTTP协议，是一个无状态协议。这意味着，所有的状态都保存在服务器端。因此，**如果客户端想要操作服务器，必须通过某种手段，让服务器端发生"状态转化"（State Transfer）。而这种转化是建立在表现层之上的，所以就是"表现层状态转化"。**
>
> 
>
> 客户端用到的手段，只能是HTTP协议。具体来说，就是HTTP协议里面，四个表示操作方式的动词：GET、POST、PUT、DELETE。它们分别对应四种基本操作：**GET用来获取资源，POST用来新建资源（也可以用于更新资源），PUT用来更新资源，DELETE用来删除资源。**
>
>  
>
> 
>
> 我们总结一下什么是RESTful架构：
>
> 　　（1）每一个URI代表一种资源；
>
> 　　（2）客户端和服务器之间，传递这种资源的某种表现层；
>
> 　　（3）客户端通过四个HTTP动词，对服务器端资源进行操作，实现"表现层状态转化"。



### 2、操作可读

| method | http幂等性 | http安全性 | 操作     | 备注 |
| ------ | ---------- | ---------- | -------- | ---- |
| post   | 否         | 否         | 增/删/改 |      |
| delete | 是         | 否         | 删       |      |
| put    | 是         | 否         | 增/改    |      |
| get    | 是         | 是         | 查       |      |

> 幂等性：对同一REST接口的多次访问，得到的资源状态是相同的。
>
> 安全性：对该REST接口访问，不会使服务器端资源的状态发生改变。

### 3、状态码可读

| code | 英文        | 注释                 | 备注                   |
| ---- | ----------- | -------------------- | ---------------------- |
| 200  | OK          | 操作成功             | post、delete、put、get |
| 201  | created     | 已被创建             | post                   |
| 202  | accepted    | 已接受请求但尚未完成 | post                   |
| 204  |             | 请求资源为空         |                        |
| 400  | bad request | 坏请求(如参数错误)   |                        |
| 404  | not found   | 资源不存在           |                        |



## (二)、grpc

https://segmentfault.com/a/1190000019376071

## (三)、thrift





()()()

# 设计模式

**核心思想**

* 对接口编程而不是对实现编程
* 优先使用对象组合而不是继承

**六大原则**

| 原则     | 解释                                                     | 举例 |
| -------- | -------------------------------------------------------- | ---- |
| 开闭     | 对扩展开放，对修改关闭                                   |      |
| 里氏代换 | 任何基类可出现的地方，子类一定可以出现                   |      |
| 依赖倒转 | 针对接口编程，依赖于抽象而不依赖于具体                   |      |
| 接口隔离 | 降低类之间的耦合                                         |      |
| 最少知道 | 一个实体应尽量少的与其它实体相互作用，使系统模块相对独立 |      |
| 合成复用 | 尽量使用合成、聚合方式，而不是用继承                     |      |

设计模式列表5+8+12=25

| 序号 | 大分类     | 设计模式                | 中文         | 场景                                                     | 备注 |
| ---- | ---------- | ----------------------- | ------------ | -------------------------------------------------------- | ---- |
| 1.1  | 创建模式   | factory  method         | 工厂方法模式 | 普通工厂方法模式<br>多个工厂方法模式<br>静态工厂方法模式 |      |
| 1.2  |            | abstract factory        | 抽象工厂模式 |                                                          |      |
| 1.3  |            | singleton               | 单例模式     |                                                          |      |
| 1.4  |            | builder                 | 建造者模式   |                                                          |      |
| 1.5  |            | prototype               | 原型模式     |                                                          |      |
| 2.1  | 结构模式   | adapter                 | 适配器模式   |                                                          |      |
| 2.2  |            | bridge                  | 桥连模式     |                                                          |      |
| 2.3  |            | filter、criteria        | 过滤器模式   | ？？                                                     |      |
| 2.4  |            | composite               | 组合模式     |                                                          |      |
| 2.5  |            | decotator               | 装饰模式     |                                                          |      |
| 2.6  |            | facade                  | 外观模式     |                                                          |      |
| 2.7  |            | flyweight               | 享元模式     |                                                          |      |
| 2.8  |            | proxy                   | 代理模式     |                                                          |      |
| 3.1  | 行为型模式 | chain of responsibility | 责任链模式   |                                                          |      |
| 3.2  |            | command                 | 命令模式     |                                                          |      |
| 3.3  |            | interpreter             | 解释器模式   |                                                          |      |
| 3.4  |            | iterator                | 迭代器模式   |                                                          |      |
| 3.5  |            | mediator                | 中介者模式   |                                                          |      |
| 3.6  |            | memento                 | 备忘录模式   |                                                          |      |
| 3.7  |            | observer                | 观察者模式   |                                                          |      |
| 3.8  |            | state                   | 状态模式     |                                                          |      |
| 3.9  |            | null object             | 空对象模式   | ？？                                                     |      |
| 3.10 |            | strategy                | 策略模式     |                                                          |      |
| 3.11 |            | template                | 模板模式     |                                                          |      |
| 3.12 |            | visitor                 | 访问者模式   |                                                          |      |

哒、、



# PSR

官方文档：https://www.php-fig.org/psr/

中文官网：http://phpfig.p2hp.com/

中文文档：https://learnku.com/docs/psr/basic-coding-standard/1605（更容易理解）

| 大类     | 功能         | psr  |
| -------- | ------------ | ---- |
| 自动加载 | 自动加载     | 4    |
| 编码风格 | 基础编码     | 1    |
|          | 基础编码扩充 | 12   |
| 接口     | 日志接口     | 3    |
|          | 缓存接口     | 6    |
|          | 简单缓存     | 16   |
|          | 服务容器接口 | 11   |
|          | 超媒体链接   | 13   |
|          | 时间调度程序 | 14   |
| http     | http消息接口 | 7    |
|          | http处理程序 | 15   |
|          | http工厂     | 17   |
|          | http客户端   | 18   |



## psr0

## psr1

* 文件以`<?php`或`<?=`开头

* 文件编码必须是：UTF-8 不带BOM

* 【副作用】单独写

* 每个类独立为一个文件，且要带namespace

* 书写规范：

  * >| 名称      | 规则                                                         | 示例                     |
    >| --------- | ------------------------------------------------------------ | ------------------------ |
    >| namespace | 任意大小写组合(可下划线）                                    | psr4。                   |
    >| class     | 驼峰命名(开头大写)                                           | MyClass                  |
    >| function  | 驼峰命名(开头小写)                                           | myFun                    |
    >| 常量      | 全大写，用下划线分割                                         | MY_DEFINE                |
    >| 属性      | 三种格式：<br>       驼峰命名(开头大写)<br>       驼峰命名(开头小写)<br>       全小写，用下划线分割 | MyPro<br>myPro<br>my_pro |
    >
    >为什么namespace可以随便大小写乱写？
    >
    >​		因为namespace的写法是依据文件物理路径的，操作系统的文件linux不分大小写，windows区分

## psr2

## psr3

## psr4

### 一个完整的namespace

| `\<NamespaceName>`     | `(\<SubNamespaceNames>)` | `\<ClassName>`         |
| ---------------------- | ------------------------ | ---------------------- |
| 顶级namespace          | 子级namespace            | 类名                   |
| 必须有                 | 可无                     | 必须有                 |
| name与物理文件夹名一致 | name与物理文件夹名一致   | name与物理文件夹名一致 |
|                        |                          | 必须以`.php`结尾       |

* 所谓的【name与物理文件夹名一致】，包括大小写（因为引入文件找的是真实物理地址，系统差异，有些是严格区分大小写的，所以强制一致）
* ==在namespace中下划线`—`是没有特殊意义的(与psr0作区分)==

### 一个类的加载过程

> ```php
> spl_autoload_register(function ($class) {
>     //禁止抛出异常
>     //禁止出现任何级别的错误
>     //不建议有返回值
> })
> ```





## psr5

## psr6

## psr7

## psr8

## psr9

## psr10

## psr11

## psr12

|              |          |                                                              |
| ------------ | -------- | ------------------------------------------------------------ |
| 文件         | 结尾     | 必须以非空行结尾，以一个Unix LF (换行符)结尾                 |
|              | php标记  | 在仅包含 PHP 代码的文件中，必须省略结尾的 `?>` 标记。        |
| 代码行       | 行长度   | 没有硬限制，软限制120个字符。<br>建议每行不超80字符，超长则拆分续行。 |
|              | 行尾     | 不能以空格结尾                                               |
|              | 语句     | 一句一行                                                     |
|              | 空行     | 可添加空行便于理解阅读                                       |
| 缩进         |          | 一次缩进 = 四个空格，而不是tab键                             |
| 关键字       | 大小写   | 所有php关键字必须小写                                        |
|              | 缩写     | 数据类型关键字必须使用缩写。如：用bool，而不是boolean        |
| 花括号       |          | 右边必须空着。既不能有代码，也不能有注释                     |
|              |          | 前后不能有除缩进之外的空格                                   |
| 类           | 继承     | `extends`和`implements`必须与类名同行                        |
|              |          | implements实现接口太多，要么全部在一行，要么一个接口一行(用一个缩进) |
|              | 左花括号 | 独立一行，上下不得有空行                                     |
|              | trait    | 必须在左花括号的下一行(即正文第一行)                         |
|              |          | trait部分与正文之间间隔一行                                  |
|              | 属性     | 必须声明可见性(public、protected、private)                   |
|              |          | 一条语句申明一个属性                                         |
|              |          | 不得以一个下划线开头命名。可以用两个下划线                   |
|              | 常量     | php7.1+,必须申明可见性(public、protected、private)           |
| function     | 命名     | 不得以一个下划线开头命名。                                   |
|              |          | 函数名和左圆括号之间不得有空格`function myFun()`             |
|              | 参数     | 不得在参数前有空格，但在参数后必须有一个空格                 |
|              |          | 带默认值的参数，必须放在参数列表最后                         |
|              |          | 参数多，要么全部一行，要么一个一行(用一个缩进)               |
|              |          | 右圆括号和左花括号之间，左花括号前必须有一个空格，且独立一行。如：`) {`或`):string {` |
|              |          | `?`和`&`后面不能有空格。如`(?int $a)`和`(&$a)`;`?-php7.1+`   |
| function调用 |          |                                                              |
|              | 右花括号 | 独立一行，上不得有空行                                       |
| 实列化       |          | 实例化的圆括号`()`必须写全，如`new self()`                   |



## psr13

## psr14

## psr15

## psr16

## psr17

## psr18

## psr19

